name: GreenCodeScan

on:
  push:
    branches:
      - master
  workflow_dispatch: # Add this trigger
    inputs: # Add inputs if required
      ref:
        description: 'Branch to run the workflow on'
        required: true
        default: 'main' # Default branch if not specified

jobs:
  copilot_suggest:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Install GitHub CLI
        run: sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-key C99B11DEB97541F0 && sudo apt-add-repository https://cli.github.com/packages && sudo apt update && sudo apt install gh

      - name: Run Copilot suggest
        run: |
          mkdir -p "/tmp/destination_folder"
          gh copilot suggest --prompts-file="../Code/GreenCodeApi/prompts.csv" --output-dir="/tmp/destination_folder"
